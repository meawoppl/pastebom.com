services:
  pastebom:
    build:
      context: .
      dockerfile: Dockerfile.rust
    ports:
      - "8081:8080"
    environment:
      - RUST_LOG=info
      - BIND_ADDR=0.0.0.0:8080
      - S3_BUCKET=${S3_BUCKET}
      - S3_PREFIX=${S3_PREFIX:-}
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_REGION=${AWS_REGION:-us-west-2}
      - BASE_URL=${BASE_URL:-http://localhost:8081}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 5s
      retries: 3
